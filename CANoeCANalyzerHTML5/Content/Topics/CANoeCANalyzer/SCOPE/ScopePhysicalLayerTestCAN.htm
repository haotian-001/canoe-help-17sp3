<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="" data-mc-search-type="Stem" data-mc-help-system-file-name="CANoeCANalyzer.xml" data-mc-path-to-help-system="../../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" /><title>Physical Layer Test for CAN (Scope)</title>
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Resources/Stylesheets/vTableMasterPageHeader.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link href="../../../Resources/Stylesheets/vStylesheet.css" rel="stylesheet" type="text/css" />
        <style>/*&lt;meta /&gt;*/

.button.expand-all-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.button.remove-highlight-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.button.collapse-all-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.needs-pie
{
	behavior: url('../../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../../Resources/Stylesheets/vTableSymbol.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapGlobal.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapDom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapUtilities.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapXhr.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapTextEffects.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapSlideshow.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapMessageBus.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapMessageBus.CrossFrame.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapDefault.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapMediaQueries.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAccessibility.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapHelpSystem.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAliasFile.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapTopicFeedback.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapFeedbackHelper.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapSkinHelper.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapToc.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapToc.Breadcrumbs.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapToc.MiniToc.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapToc.SideMenu.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapIndex.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapGlossary.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapParser.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapSearch.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapNavigateTopics.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapLms.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapELearning.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapTopic.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapFeedback.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapMicroContentComponent.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapSearchHelper.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapTopicElements.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapTriPane.js" type="text/javascript" defer="defer">
        </script>
        <script type="text/jscript" src="../../../Resources/vScripts/SyntaxHighlighting.js">
        </script>
        <script type="text/jscript" src="../../../Resources/vScripts/TabSwitch.js">
        </script>
        <script type="text/javascript" src="../../../Resources/vScripts/Vector.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../../CANoeCANalyzer.htm#Topics/CANoeCANalyzer/SCOPE/ScopePhysicalLayerTestCAN.htm">Open topic with navigation</a>
        </p>
        <div class="Body">
            <div role="main" id="mc-main-content">
                <div>
                    <p class="StructurePath"><a href="Scope.htm" class="StructurePath">Scope</a> » <a href="ScopePhysicalLayerTest.htm" class="StructurePath">Physical Layer Test</a> » CAN</p>
                    <h1>Physical Layer Test for CAN</h1>
                    <p class="MenuPath">&#160;</p>
                    <p class="AutoSearchFilterConcepts"><a name="aanchor8759"></a>
                        <MadCap:concept term="SFCore" />
                    </p>
                    <p class="IndexConcept"><a name="kanchor7141"></a>
                    </p>
                </div>
                <p>The signal quality of a CAN high-speed channel can be verified with the bitmask analysis.</p>
                <p>The bitmask defines an area through which the signal must not cut. If portions of the signal are located within the bitmask, the Scope signals this as a bitmask violation.</p>
                <div>
                    <h2 class="SectionSub">Functions/Characteristics</h2>
                    <ul>
                        <li>The bitmask analysis is integrated in the <span class="Product">Scope</span> option.</li>
                        <li>The bitmask analysis is performed with the differential CAN signal.</li>
                        <li>The bitmask analysis is possible with classic CAN and with CAN FD.</li>
                        <li>The differential CAN signal is analyzed according to the CAN specification. The synchronization occurs at recessive-dominant edges, taking into consideration the configured synchronization jump width.</li>
                        <li>The bitmasks can be defined by the user.</li>
                        <li>The analysis is controlled by a user-programmable CAPL test node.</li>
                        <li>A complete CAN message from the SOF to the EOF can be analyzed. However it is also possible to limit the analysis to individual message segments.</li>
                        <li>The variety of trigger possibilities enables automated testing of a specific message, all messages of a send node, or any other combination of messages.</li>
                        <li>The result of the analysis is written in a test report.</li>
                        <li>In addition to the written test evaluation, the test report can contain screenshots of the Scope diagram. It is also possible to display the utilized bitmasks.</li>
                    </ul>
                </div>
                <div>
                    <h2 class="SectionSub">Configuration</h2>
                    <ul>
                        <li>Connect a CAN channel of a Vector network interface to the CAN bus to be analyzed.</li>
                        <li>Connect the <span class="Product">PicoScope</span> channels to the CAN bus with the probe cable.</li>
                        <li>Connect the hardware trigger connection of the Vector network interface to the trigger input of the <span class="Product">PicoScope</span>.</li>
                        <li>Create a <span class="Product">CANoe</span> configuration.</li>
                        <li class="Indent">Display the Scope Window on one of the desktops and configure it.</li>
                        <li class="Indent">The best analysis results are obtained when you set the highest possible sampling rate. The pre-trigger and post-trigger should be placed in such a way that a complete CAN message can be recorded problem-free.</li>
                        <li class="Indent">If you would like to generate screenshots of the Scope Window and include them in the test report, ensure that the window size is appropriate and the window layout will fit (size of the diagram area, the Trace area, and the configuration/data area).</li>
                        <li class="Indent">Configure the baudrate and the bit timing of the CAN channel. If <span class="Product">CANoe</span> is only receiving, you can activate <span class="GUI">Tx-Off</span> mode.</li>
                    </ul>
                    <div>
                        <table style="width: 100%;margin-left: 0;margin-right: auto;mc-table-style: url('../../../Resources/Stylesheets/vTableSymbol.css');" class="TableStyle-vTableSymbol" cellspacing="0">
                            <col class="TableStyle-vTableSymbol-Column-Column1" />
                            <col class="TableStyle-vTableSymbol-Column-Column2" />
                            <tbody>
                                <tr>
                                    <td class="TableStyle-vTableSymbol-BodyB-Column1-">
                                        <p class="Table">
                                            <img src="../../../Resources/vImages/vInfo.png" style="width: 48px;height: 45px;" title="Note" alt="Note" />
                                        </p>
                                    </td>
                                    <td class="TableStyle-vTableSymbol-BodyA-Column2-">
                                        <p class="TableSymbolHead">Note</p>
                                        <p>The baudrate and the bit timing are also used by the Scope parser and influence the analysis.</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div>
                    <h2 class="SectionSub">Measurement</h2>
                    <ul>
                        <li>Start the measurement (<a href="../Ribbon/RibbonHome.htm"><span class="GUI">Home</span> ribbon tab</a> or <span class="GUI">&lt;F9&gt;</span> function key).</li>
                        <li>Start the test module in the <span class="GUI">ScopeBitAnalysisCAN</span> Window with the <span class="GUI">Start</span> button.</li>
                        <li>The test node contains a CAPL library that performs the following actions:</li>
                        <li class="Indent">Wait for the message that is to be analyzed</li>
                        <li class="Indent">Trigger Scope (<a href="../../CAPLFunctions/Scope/Functions/CAPLfunctionScopeTriggerNow.htm">ScopeTriggerNow</a>)</li>
                        <li class="Indent">Start the analysis (<a href="../../CAPLFunctions/Test/Functions/CAPLfunctionTestWaitScopeAnalyseSignal.htm">TestWaitScopeAnalyseSignal</a>)</li>
                        <li class="Indent">Check the results</li>
                        <li class="Indent">Create the test report</li>
                    </ul>
                    <p class="StartList">You can get details on bitmask violations with the following CAPL function:</p>
                    <ul>
                        <li><a href="../../CAPLFunctions/Test/Functions/CAPLfunctionTestWaitScopeGetMaskViolation.htm">TestWaitScopeGetMaskViolation</a>
                        </li>
                    </ul>
                    <p class="StartList">If you want to include screenshots in the test report, you can display the desired message segment with the following CAPL functions:</p>
                    <ul>
                        <li><a href="../../CAPLFunctions/Test/Functions/CAPLfunctionTestWaitForScopeFitData.htm">TestWaitForScopeFitData</a> (display of a message segment)</li>
                        <li><a href="../../CAPLFunctions/Test/Functions/CAPLfunctionTestWaitScopeShowMask.htm">TestWaitScopeShowMask</a> (display of a message segment with the bitmasks)</li>
                    </ul>
                    <p class="StartList">With the following CAPL function, you generate a screenshot and add it to the test report.</p>
                    <ul>
                        <li><a href="../../CAPLFunctions/Test/Functions/CAPLfunctionTestReportAddWindowCapture.htm">TestReportAddWindowCapture</a>
                        </li>
                    </ul>
                </div>
                <div>
                    <h2 class="SectionSub">Defining Bitmasks</h2>
                    <p>The bitmask is defined with up to 10 data points. The following figure shows a bitmask in a dominant bit.</p>
                    <p>
                        <img src="../../../Resources/Images/CANoeCANalyzer/ScopeBitmaskDefinition.png" />
                    </p>
                    <p>In the example above, the Scope parser has synchronized the bit start to the recessive-dominant bit change. The dominant bit has a light gray background. The bit length corresponds to the theoretical length of 2 us.</p>
                    <p>The bitmask is plotted as a green hatched area. In the direction of negative voltages (in the example above), the bitmask is unlimited. However, below a certain voltage, it is no longer plotted.</p>
                    <p class="StartList">The bitmask was defined with 4 data points.</p>
                    <ul>
                        <li>Point 1: 30.00%, 1100 mV</li>
                        <li>Point 2: 35.00%, 1900 mV</li>
                        <li>Point 3: 83.33%, 1900 mV</li>
                        <li>Point 4: 87.50%, 1400 mV</li>
                    </ul>
                    <p>The percentages represent the percentage of the theoretical bit length. The voltages are relative to the Scope ground.</p>
                    <p>In the case of CAN FD, if a different baudrate is used for the data phase than for the arbitration phase, the specific bit widths must be considered during mask definition.</p>
                    <p>The bitmask data points for BRS relate to the arbitration baudrate, while the data points for the CRC delimiter relate to the data phase baudrate. For the bitmask definition, it is therefore necessary to calculate the theoretical bit lengths relative to the respective reference baudrate. In the <a href="../../SampConf/CAN/CANoe/Scope/BitmaskAnalysisCAN.htm" class="bold">Scope for CAN bitmask analysis</a> sample configuration, this occurs in the <span class="bold">InitBitMaskBRS</span> and <span class="bold">InitBitMaskCRCdel</span> functions. The data points 3 and 4 are placed in such a way that the sampling point is located between data points 2 and 3.</p>
                    <p>Since the bitmasks for BRS and the CRC delimiter differ from the arbitration phase and data phase bitmasks, these two bits can be analyzed only individually.</p>
                    <p>BRS with bitmask:</p>
                    <p>
                        <img src="../../../Resources/Images/CANoeCANalyzer/ScopeBitmaskBRS.png" />
                    </p>
                </div>
                <div>
                    <h2 class="SectionSub">Representation of the Bitmasks in the Scope Diagram</h2>
                    <p>The following figure shows an excerpt from the created test report. The message segment contains bitmask violations as well as bits without bitmask violations.</p>
                    <p>
                        <img src="../../../Resources/Images/CANoeCANalyzer/ScopeBitmaskDiagram_950x405.png" style="width: 950;height: 405;" />
                    </p>
                    <p>The green hatched bitmasks are from bits without mask violations.</p>
                    <p>The red bitmasks identify bits with mask violations. The error text describes the violation of the bitmask plotted in full-tone red.</p>
                </div>
                <div>
                    <h2 class="SectionSub">Configuring Bit Timings and Scope</h2>
                    <p>The Scope message parser analyzes the signal recorded by the Scope. In particular, it synchronizes to recessive-dominant edges and determines the logical value of each bit of the message at its sampling point. It uses the bit timing configuration of the channel as configuration parameters (baudrate, sampling point, synchronization jump width).</p>
                    <p>Although the parser operates according to the CAN specification, deviations from the message signaled by the CAN interface may occur in rare cases – in particular, in the case of very faulty signals. For this reason, a consistency check is performed after the parsing. If a discrepancy is identified, an error is returned.</p>
                    <p class="StartList">If frequent parser errors occur, you should check the following:</p>
                    <ul>
                        <li><span class="bold">Is the Scope sampling rate high enough?</span>
                            <br />At low samplings/bit, the synchronization can become too imprecise and the bit sampling point can deviate too much from the configured sampling point.<br />(The logical bit value is obtained from the Scope sample that is nearest the configured sampling point.)</li>
                        <li><span class="bold">Is the synchronization jump width too large?</span>
                            <br />If the bit is faulty and the synchronization jump width is large, the parser might synchronize to an incorrect signal edge.</li>
                        <li><span class="bold">Is the synchronization jump width too small?</span>
                            <br />If the bitrate discrepancy is large and the synchronization jump width is small, the signal edge at the bit start might not be found and the bit start is then not synchronized to the edge.</li>
                        <li><span class="bold">Using non-CAN-compliant synchronization.</span>
                            <br />With the flags of CAPL function <a href="../../CAPLFunctions/Test/Functions/CAPLfunctionTestWaitScopeAnalyseSignal.htm">testWaitScopeAnalyseSignal</a>, the synchronization to dominant-recessive signal edges can be activated additionally.</li>
                    </ul>
                </div>
                <p class="LinkList"><a href="../../SampConf/CAN/CANoe/Scope/BitmaskAnalysisCAN.htm" class="LinkList">Sample Configuration for CAN Bitmask Analysis</a>
                </p>
            </div>
        </div>
        <div class="Footer">
            <div class="FooterWhite">
                <table class="FooterWhite" style="border-collapse: collapse;margin-left: auto;margin-right: auto;">
                    <col style="width: 70px;" data-mc-conditions="vConditions.HTML5Link" />
                    <col style="width: 16px;" data-mc-conditions="vConditions.HTML5Link" />
                    <col />
                    <tbody>
                        <tr>
                            <td>
                                <div class="buttons popup-container clearfix topicToolbarProxy topicToolbarProxyFooter _Skins_HTML5TopicToolbar mc-component nocontent">
                                    <div class="button-group-container-left">
                                        <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                            <div>
                                                <div role="img" class="button-icon-wrapper" aria-label="Expand all">
                                                    <div class="button-icon"> </div>
                                                </div>
                                            </div>
                                        </button>
                                        <button class="button needs-pie remove-highlight-button" title="Remove Highlights">
                                            <div>
                                                <div role="img" class="button-icon-wrapper">
                                                    <div class="button-icon"> </div>
                                                </div>
                                            </div>
                                        </button>
                                    </div>
                                </div>
                            </td>
                            <td>
                                <p class="vec_BuildInfo"><a href="../../Shared/HowToUseOnlineHelp.htm" title="Tips for using the help" alt="Tips for using the help"><img src="../../../Resources/vImages/vBackstage/vHelpInfo.png" /></a>
                                </p>
                            </td>
                            <td>
                                <p class="vec_BuildInfo" style="text-align: right;"><span class="mc-variable Vector.BuildTime variable">2023-09-26T19:49:32</span>
                                </p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <table style="width: 100%;border-collapse: separate;border-spacing: 3px 0px;margin-left: auto;margin-right: auto;caption-side: top;">
                <col />
                <col />
                <col />
                <col data-mc-conditions="vConditions.HTML5Link" />
                <tbody>
                    <tr>
                        <td style="background-color: #b70032;padding-left: 5pt;padding-right: 5pt;padding-top: 5pt;padding-bottom: 5pt;">
                            <p class="vec_Footer">©&#160;Vector Informatik GmbH</p>
                        </td>
                        <td style="background-color: #b70032;padding-left: 5pt;padding-right: 5pt;padding-top: 5pt;padding-bottom: 5pt;text-align: right;">
                            <p class="vec_FooterBold">
                                <MadCap:conditionalText data-mc-conditions="vConditions.vTESTstudioExcluded,vConditions.TestDataEditorExcluded">CANoe</MadCap:conditionalText> Version <MadCap:conditionalText data-mc-conditions="vConditions.vTESTstudioExcluded">17 SP3</MadCap:conditionalText></p>
                        </td>
                        <td style="background-color: #b70032;padding-left: 5pt;padding-right: 5pt;padding-top: 5pt;padding-bottom: 0pt;text-align: right;">
                            <p class="vec_Footer"><a href="../../Shared/ContactCopyrightLicense.htm" class="vec_Footer MCXref xref xrefvec_Footer">Contact/Copyright/License</a>
                            </p>
                        </td>
                        <td style="background-color: #b70032;padding-left: 5pt;padding-right: 5pt;padding-top: 5pt;padding-bottom: 0pt;text-align: right;">
                            <p class="vec_Footer"><a href="https://www.vector.com/int/en/company/get-info/privacy-policy/" target="_blank" class="vec_Footer">Data Privacy Notice</a>
                            </p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </body>
</html>
<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="CANoeCANalyzer.xml" data-mc-path-to-help-system="../../../../" data-mc-conditions="vConditions.CANoeOnly" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" /><title>Example for Maps &amp; Curves (XCP)</title>
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Resources/Stylesheets/vTableMasterPageHeader.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link href="../../../Resources/Stylesheets/vStylesheet.css" rel="stylesheet" type="text/css" />
        <style>/*&lt;meta /&gt;*/

.button.expand-all-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.button.remove-highlight-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.button.collapse-all-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.needs-pie
{
	behavior: url('../../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../../Resources/Stylesheets/vTableSymbol.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapGlobal.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapDom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapUtilities.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapXhr.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapTextEffects.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapSlideshow.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapMessageBus.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapMessageBus.CrossFrame.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapDefault.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapMediaQueries.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAccessibility.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapHelpSystem.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAliasFile.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapTopicFeedback.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapFeedbackHelper.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapSkinHelper.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapToc.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapToc.Breadcrumbs.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapToc.MiniToc.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapToc.SideMenu.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapIndex.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapGlossary.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapParser.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapSearch.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapNavigateTopics.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapLms.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapELearning.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapTopic.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapFeedback.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapMicroContentComponent.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapSearchHelper.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapTopicElements.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapTriPane.js" type="text/javascript" defer="defer">
        </script>
        <script type="text/jscript" src="../../../Resources/vScripts/SyntaxHighlighting.js">
        </script>
        <script type="text/jscript" src="../../../Resources/vScripts/TabSwitch.js">
        </script>
        <script type="text/javascript" src="../../../Resources/vScripts/Vector.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../../CANoeCANalyzer.htm#Topics/CANoeCANalyzer/AMDXCP/XCPMapsCurves.htm">Open topic with navigation</a>
        </p>
        <div class="Body">
            <div role="main" id="mc-main-content">
                <div>
                    <p class="StructurePath"><a href="AMDXCP.htm" class="StructurePath">Option&#160;AMD/XCP</a> » Example for Maps and Curves</p>
                    <h1>Example for Maps &amp; Curves</h1>
                    <p class="MenuPath">&#160;</p>
                    <p class="AutoSearchFilterConcepts"><a name="aanchor3124"></a>
                        <MadCap:concept term="SFCore" />
                    </p>
                    <p class="IndexConcept"><a name="kanchor2447"></a>
                    </p>
                </div>
                <p>In <span class="Product">CANoe</span> the data types <span class="bold">Maps</span> and <span class="bold">Curves</span> are represented via <a href="../../Shared/SystemVariables/SysVar.htm"><span class="bold">Structs</span> system variables</a>. Each axis/dimension is assigned to a struct member.<br />For maps maximum 3 dimensions are supported!</p>
                <p>Maps and Curves are available since <span class="Product">CANoe</span> version <span class="bold">8.0 SP4</span>.</p>
                <div>
                    <table style="width: 100%;margin-left: 0;margin-right: auto;mc-table-style: url('../../../Resources/Stylesheets/vTableSymbol.css');" class="TableStyle-vTableSymbol" cellspacing="0">
                        <col class="TableStyle-vTableSymbol-Column-Column1" />
                        <col class="TableStyle-vTableSymbol-Column-Column2" />
                        <tbody>
                            <tr>
                                <td class="TableStyle-vTableSymbol-BodyB-Column1-">
                                    <p class="Table">
                                        <img src="../../../Resources/vImages/vExample.png" style="width: 48px;height: 45px;" title="Example" alt="Example" />
                                    </p>
                                </td>
                                <td class="TableStyle-vTableSymbol-BodyA-Column2-">
                                    <p class="TableSymbolHead">Example 1</p>
                                    <p class="Table"><span class="bold">KL2</span> is a <span class="bold">Curve</span> with 2x Shared Axis. The system variable gets 2 fields. The first field contains the interpolation points of the axis and the second field contains the data; see the following figure from the <a href="../../Shared/SymbolExplorer.htm">Symbol Explorer</a>.</p>
                                    <p>
                                        <img src="../../../Resources/Images/CANoeCANalyzer/XCPDefinitionSysVarStruct1.png" />
                                    </p>
                                    <p>Each axis/data field is defined as <span class="bold">Array</span> of <span class="bold">Doubles</span>. In the <a href="../Windows/Trace/TraceWindow.htm">Trace Window</a> the fields of the system variables are displayed one below the other.</p>
                                    <p>
                                        <img src="../../../Resources/Images/CANoeCANalyzer/XCPTraceSysVarStructs1.png" />
                                    </p>
                                    <h2>Code Example for an Upload with a <a href="../Test/TestFeatureSet/TFSTestModuleSetup.htm">CAPL Test Node</a> in the <a href="../Windows/SimulationSetup/SimulationSetupWindow.htm">Simulation Setup</a></h2>
                                    <p>In the following example the <span class="bold">Curve KL2</span> is read. For each axis or data array the values must be read in <span class="bold">Array</span> format.</p>
                                    <p class="SourceCode">testcase TC_Upload_KL2()<br />{<br />&#160;&#160;int i;<br />&#160;&#160;double dataReceived[8];<br />&#160;&#160;int failed = RESULT_OK;<br />&#160;&#160;sysGetVariableFloatArray("", "XCP::ECU_2::KL2.Curve2", dataReceived, 8);<br />&#160;&#160;failed |= dataReceived[0] != 11;<br />&#160;&#160;failed |= dataReceived[1] != 12;<br />&#160;&#160;failed |= dataReceived[2] != 13;<br />&#160;&#160;failed |= dataReceived[3] != 14;<br />&#160;&#160;failed |= dataReceived[4] != 15;<br />&#160;&#160;failed |= dataReceived[5] != 16;<br />&#160;&#160;failed |= dataReceived[6] != 18;<br />&#160;&#160;failed |= dataReceived[7] != 22;<br />&#160;&#160;if(failed == RESULT_FAILED)<br />&#160;&#160;{<br />&#160;&#160;&#160;&#160;testStepFail("TC_Download_KL2: Wrong data received from XCP::ECU_2::KL2.Curve2.");<br />&#160;&#160;&#160;&#160;return;<br />&#160;&#160;}<br />&#160;&#160;sysGetVariableFloatArray("", "XCP::ECU_2::KL2.Data", dataReceived, 8);<br />&#160;&#160;failed |= dataReceived[0] != 1;<br />&#160;&#160;failed |= dataReceived[1] != 2;<br />&#160;&#160;failed |= dataReceived[2] != 3;<br />&#160;&#160;failed |= dataReceived[3] != 4;<br />&#160;&#160;failed |= dataReceived[4] != 5;<br />&#160;&#160;failed |= dataReceived[5] != 6;<br />&#160;&#160;failed |= dataReceived[6] != 8;<br />&#160;&#160;failed |= dataReceived[7] != 12;<br />&#160;&#160;if(failed == RESULT_FAILED)<br />&#160;&#160;{<br />&#160;&#160;&#160;&#160;testStepFail("TC_Download_KL2: Wrong data received from XCP::ECU_2::KL2.Data.");<br />&#160;&#160;&#160;&#160;return;<br />&#160;&#160;}<br />}</p>
                                    <p>At writing of maps and curves via system variables, updates of system variables must be blocked before the set call to avoid immediate updates of the values of the axis points. This can be done with the <a href="../../CAPLFunctions/SystemVariables/Functions/CAPLfunctionSysBeginVariableStructUpdate.htm">sysBeginVariableStructUpdate</a> function. With this function the write procedure of the system variable is blocked as long it will be released with <a href="../../CAPLFunctions/SystemVariables/Functions/CAPLfunctionSysEndVariableStructUpdate.htm">sysEndVariableStructUpdate</a>. Between these two functions the values for data fields and the interpolation points of the axis can be set.</p>
                                    <p class="SourceCode">void Download_KL2()<br />{<br />&#160;&#160;double a[8];<br />&#160;&#160;int i;<br />&#160;&#160;// block of the system variable to avoid immediate execution of updates<br />&#160;&#160;sysBeginVariableStructUpdate(sysvar::XCP::ECU_2::KL2);<br />&#160;&#160;for (i = 0; i &lt; 8; ++i)<br />&#160;&#160;{<br />&#160;&#160;&#160;&#160;a[i] = i + 1;<br />&#160;&#160;}<br />&#160;&#160;// assign values of interpolation points to the system variable<br />&#160;&#160;sysSetVariableFloatArray("", "XCP::ECU_2::KL2.Curve2", a, 8);<br />&#160;&#160;for (i = 0; i &lt; 8; ++i)<br />&#160;&#160;{<br />&#160;&#160;&#160;&#160;a[i] = (i + 1)*10;<br />&#160;&#160;}<br />&#160;&#160;// assign data values to the system variable<br />&#160;&#160;sysSetVariableFloatArray("", "XCP::ECU_2::KL2.Data", a, 8);<br />&#160;&#160;// release and download to XCP slave<br />&#160;&#160;sysEndVariableStructUpdate(sysvar::XCP::ECU_2::KL2);<br />}</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div>
                    <table style="width: 100%;margin-left: 0;margin-right: auto;mc-table-style: url('../../../Resources/Stylesheets/vTableSymbol.css');" class="TableStyle-vTableSymbol" cellspacing="0">
                        <col class="TableStyle-vTableSymbol-Column-Column1" />
                        <col class="TableStyle-vTableSymbol-Column-Column2" />
                        <tbody>
                            <tr>
                                <td class="TableStyle-vTableSymbol-BodyB-Column1-">
                                    <p class="Table">
                                        <img src="../../../Resources/vImages/vExample.png" style="width: 48px;height: 45px;" title="Example" alt="Example" />
                                    </p>
                                </td>
                                <td class="TableStyle-vTableSymbol-BodyA-Column2-">
                                    <p class="TableSymbolHead">Example 2</p>
                                    <p>For axis of type <span class="bold">FIX</span> the interpolation point values of the axis are not read or written at upload/download. For a better display these interpolation points are displayed</p>
                                    <ul>
                                        <li>for the system variable in the <a href="../../Shared/SymbolExplorer.htm">Symbol Explorer</a></li>
                                    </ul>
                                    <p class="Result">
                                        <img src="../../../Resources/Images/CANoeCANalyzer/XCPDefinitionSysVarStruct2.png" />
                                    </p>
                                    <ul>
                                        <li>during the measurement in the <a href="../Windows/Trace/TraceWindow.htm">Trace Window</a></li>
                                    </ul>
                                    <p class="Result">
                                        <img src="../../../Resources/Images/CANoeCANalyzer/XCPTraceSysVarStructs2.png" />
                                    </p>
                                    <h2>Code Example with a FIX Axis (<a href="../Test/TestFeatureSet/TFSTestModuleSetup.htm">CAPL Test Node</a> in <a href="../Windows/SimulationSetup/SimulationSetupWindow.htm">Simulation Setup</a>)</h2>
                                    <p class="SourceCode">testcase TC_Upload_KL6()<br />{<br />int i;<br />double dataReceived[8];<br />int failed = RESULT_OK;<br />sysGetVariableFloatArray("", "XCP::ECU_2::KL6.Data", dataReceived, 8);<br />failed |= dataReceived[0] != 21;<br />failed |= dataReceived[1] != 22;<br />failed |= dataReceived[2] != 23;<br />failed |= dataReceived[3] != 24;<br />failed |= dataReceived[4] != 25;<br />failed |= dataReceived[5] != 26;<br />failed |= dataReceived[6] != 28;<br />failed |= dataReceived[7] != 32;<br />if(failed == RESULT_FAILED)<br />{<br />testStepFail("TC_Upload_KL6: Wrong data received from XCP::ECU_2::KL6.Data.");<br />return;<br />}<br />}</p>
                                    <h2>Code Example for a Download</h2>
                                    <p class="SourceCode">void Download_KL6()<br />{<br />double a[8];<br />int i;<br />&#160;&#160;// block of the system variable to avoid immediate execution of updates<br />sysBeginVariableStructUpdate(sysvar::XCP::ECU_2::KL6);<br />for (i = 0; i &lt; 8; ++i)<br />{<br />a[i] = (i + 1)*10;<br />}<br />&#160;&#160;// assign data values to the system variable<br />sysSetVariableFloatArray("", "XCP::ECU_2::KL6.Data", a, 8);<br />&#160;&#160;// release and download to XCP slave<br />sysEndVariableStructUpdate(sysvar::XCP::ECU_2::KL6);<br />}</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p class="LinkList">&#160;</p>
            </div>
        </div>
        <div class="Footer">
            <div class="FooterWhite">
                <table class="FooterWhite" style="border-collapse: collapse;margin-left: auto;margin-right: auto;">
                    <col style="width: 70px;" data-mc-conditions="vConditions.HTML5Link" />
                    <col style="width: 16px;" data-mc-conditions="vConditions.HTML5Link" />
                    <col />
                    <tbody>
                        <tr>
                            <td>
                                <div class="buttons popup-container clearfix topicToolbarProxy topicToolbarProxyFooter _Skins_HTML5TopicToolbar mc-component nocontent">
                                    <div class="button-group-container-left">
                                        <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                            <div>
                                                <div role="img" class="button-icon-wrapper" aria-label="Expand all">
                                                    <div class="button-icon"> </div>
                                                </div>
                                            </div>
                                        </button>
                                        <button class="button needs-pie remove-highlight-button" title="Remove Highlights">
                                            <div>
                                                <div role="img" class="button-icon-wrapper">
                                                    <div class="button-icon"> </div>
                                                </div>
                                            </div>
                                        </button>
                                    </div>
                                </div>
                            </td>
                            <td>
                                <p class="vec_BuildInfo"><a href="../../Shared/HowToUseOnlineHelp.htm" title="Tips for using the help" alt="Tips for using the help"><img src="../../../Resources/vImages/vBackstage/vHelpInfo.png" /></a>
                                </p>
                            </td>
                            <td>
                                <p class="vec_BuildInfo" style="text-align: right;"><span class="mc-variable Vector.BuildTime variable">2023-09-26T19:49:32</span>
                                </p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <table style="width: 100%;border-collapse: separate;border-spacing: 3px 0px;margin-left: auto;margin-right: auto;caption-side: top;">
                <col />
                <col />
                <col />
                <col data-mc-conditions="vConditions.HTML5Link" />
                <tbody>
                    <tr>
                        <td style="background-color: #b70032;padding-left: 5pt;padding-right: 5pt;padding-top: 5pt;padding-bottom: 5pt;">
                            <p class="vec_Footer">©&#160;Vector Informatik GmbH</p>
                        </td>
                        <td style="background-color: #b70032;padding-left: 5pt;padding-right: 5pt;padding-top: 5pt;padding-bottom: 5pt;text-align: right;">
                            <p class="vec_FooterBold">
                                <MadCap:conditionalText data-mc-conditions="vConditions.vTESTstudioExcluded,vConditions.TestDataEditorExcluded">CANoe</MadCap:conditionalText> Version <MadCap:conditionalText data-mc-conditions="vConditions.vTESTstudioExcluded">17 SP3</MadCap:conditionalText></p>
                        </td>
                        <td style="background-color: #b70032;padding-left: 5pt;padding-right: 5pt;padding-top: 5pt;padding-bottom: 0pt;text-align: right;">
                            <p class="vec_Footer"><a href="../../Shared/ContactCopyrightLicense.htm" class="vec_Footer MCXref xref xrefvec_Footer">Contact/Copyright/License</a>
                            </p>
                        </td>
                        <td style="background-color: #b70032;padding-left: 5pt;padding-right: 5pt;padding-top: 5pt;padding-bottom: 0pt;text-align: right;">
                            <p class="vec_Footer"><a href="https://www.vector.com/int/en/company/get-info/privacy-policy/" target="_blank" class="vec_Footer">Data Privacy Notice</a>
                            </p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </body>
</html>
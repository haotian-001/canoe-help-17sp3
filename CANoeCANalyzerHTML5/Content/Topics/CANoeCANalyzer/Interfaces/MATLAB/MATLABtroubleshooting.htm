<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="CANoeCANalyzer.xml" data-mc-path-to-help-system="../../../../../" data-mc-conditions="vConditions.CANoeOnly" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../../Skins/Favicons/favicon-16x16.png" /><title>Troubleshooting (MATLAB Integration)</title>
        <link href="../../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Resources/Stylesheets/vTableMasterPageHeader.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link href="../../../../Resources/Stylesheets/vStylesheet.css" rel="stylesheet" type="text/css" />
        <style>/*&lt;meta /&gt;*/

.button.expand-all-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.button.remove-highlight-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.button.collapse-all-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.needs-pie
{
	behavior: url('../../../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link rel="apple-touch-icon" sizes="180x180" href="../../../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/foundation.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapGlobal.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapDom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapUtilities.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapXhr.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapTextEffects.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapSlideshow.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapMessageBus.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapMessageBus.CrossFrame.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapDefault.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapMediaQueries.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapAccessibility.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapHelpSystem.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapAliasFile.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapTopicFeedback.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapFeedbackHelper.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapSkinHelper.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapToc.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapToc.Breadcrumbs.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapToc.MiniToc.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapToc.SideMenu.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapIndex.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapGlossary.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapParser.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapSearch.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapNavigateTopics.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapLms.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapELearning.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapTopic.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapFeedback.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapMicroContentComponent.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapSearchHelper.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapTopicElements.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapTriPane.js" type="text/javascript" defer="defer">
        </script>
        <script type="text/jscript" src="../../../../Resources/vScripts/SyntaxHighlighting.js">
        </script>
        <script type="text/jscript" src="../../../../Resources/vScripts/TabSwitch.js">
        </script>
        <script type="text/javascript" src="../../../../Resources/vScripts/Vector.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../../../CANoeCANalyzer.htm#Topics/CANoeCANalyzer/Interfaces/MATLAB/MATLABtroubleshooting.htm">Open topic with navigation</a>
        </p>
        <div class="Body">
            <div role="main" id="mc-main-content">
                <p class="StructurePath"><a href="MATLAB.htm" class="StructurePath">MATLAB Integration Package</a> » Troubleshooting</p>
                <h1>Troubleshooting</h1>
                <p class="MenuPath">&#160;</p>
                <p class="AutoSearchFilterConcepts"><a name="aanchor3828"></a>
                    <MadCap:concept term="SFInterfaces" />
                </p>
                <p><a name="kanchor2972"></a>
                </p>
                <div>
                    <h2>Unusable CANoe GUI during offline simulation</h2>
                    <p>It can happen that the <span class="Product">CANoe</span> user interface doesn’t update correctly or isn’t usable at all when operation in offline mode. If so, open the CAN.INI configuration file and verify that the following entry is set to zero:</p>
                    <p class="SourceCode">[System]
GUIThreadPriority=0</p>
                    <p>The default setting for this entry is <span class="bold">–3</span> which lowers the priority of the <span class="Product">CANoe</span> GUI.</p>
                    <h2>Unable to compile the nlapml.CPP source file.</h2>
                    <p>If the compilation of the source file fails with the following error:
</p>
                    <p class="SourceCode">error C2117: 'test_for_long_filename_init' : array bounds overflow</p>
                    <p>
you’ve activated the export of CAPL functions in the code generation options and the filename of your model is longer than 44 characters. If you really need the CAPL functions save your model under a shorter name. If you don’t need the additional CAPL functions, deactivate the export in the <span class="bold">CN code generation options</span>.</p>
                </div>
                <div>
                    <h2>Model Advisor Checks not available</h2>
                    <p>After installation of the <span class="Product">CANoe</span>MATLAB Integration Package the Simulink Model Advisor should contain a new folder named <span class="bold">CANoe MATLAB Integration Checks</span> below the <span class="bold">By Product</span> section. The <span class="Product">CANoe</span> checks are created by the <span class="bold">sl_customization.m</span> file located in the folder <span class="SourceCode">$(My Documents)\Matlab\CANoe\Samples</span>. Please make sure that this folder is included in the MATLAB path list (menu path <span class="bold">File|Set Path</span>). MATLAB updates all customizations if the command <span class="bold">slcustomize</span> is called. Please make sure that you have the Simulink Verification and Validation Toolbox installed, which supports custom checks for the Model Advisor.</p>
                </div>
                <div>
                    <h2><a name="HighCPUloadDuringSimulation" id="HighCPUloadDuringSimulation"></a>High CPU load during simulation</h2>
                    <p>If the simulation is run in synchronous mode, best synchronization results are achieved by using a <span class="bold">busy wait</span> function in Simulink. The advantage is that the simulation remains active and is just delayed by the <span class="bold">Simulation Step</span> block. The block continuously checks the current time of <span class="Product">CANoe</span> until the next simulation step must be computed.
Therefore it is recommended to use a multi core processor. In this case Simulink will cause up to 100% load at one of the CPU's cores while <span class="Product">CANoe</span> can be computed by the other core. Using a single core processor <span class="Product">CANoe</span> and Simulink have to share the capacity of the CPU possibly resulting in less exact simulation results.
In Offline mode it not critical how fast Simulink can compute the model since <span class="Product">CANoe</span> interrupts its simulation and resumes correctly synchronized with Simulink. Since the simulation runs as fast as possible, it will also use most of the CPU capacity available.</p>
                </div>
                <div>
                    <h2>No data exchange with CANoe in Synchronized or Offline Mode</h2>
                    <p>Newer versions of MATLAB are optimized to compute parts of the model in parallel what results in a better usage of multi-core CPUs. This feature can be used but it has to be assured that all <span class="Product">CANoe</span>MATLAB Integration Package blocks are calculated in one single task. Especially the <span class="bold">Simulation Step</span> block may not be computed independent from the input/output blocks since this block manages the time and data exchange. In case the computation order is wrong, no data will be transmitted from or to <span class="Product">CANoe</span>.</p>
                    <p>The easiest way to prevent this is by setting the tasking mode of the model to <span class="bold">SingleTasking</span>. Open the menu path <span class="bold">Simulation|Configuration Parameters</span> to open the settings dialog of a model. Go to the <span class="bold">Solver Settings</span> and change the <span class="bold">Tasking mode for periodic sample times</span> value.</p>
                </div>
                <div>
                    <h2>Synchronous Mode in Distributed Environments</h2>
                    <p>A distributed environment exists when you are using <span class="Product">VN8900</span>, <span class="Product">VT6000</span> or distributed mode for example. In these cases, the analysis area (Measurement Setup) and the simulation area (Simulation Setup, test environment) are distributed between two separate computers. It is not possible to use synchronous mode in distributed environments. The reason for this is that during the co-simulation, a direct, i.e., unbuffered, data exchange must take place between Simulink and <span class="Product">CANoe</span>. This is not possible across computer boundaries in distributed environments. For the distributed case, it is recommended that a DLL file be generated from the Simulink model and integrated into the <span class="Product">CANoe</span> simulation.</p>
                </div>
                <div>
                    <h2>The Model takes a very long Time to Build</h2>
                    <p>Large models can take a very long time to build. The <span class="GUI">Generating Code</span> message can then be seen in MATLAB as the last message of the build process. This behavior is caused by the fact that Microsoft compilers have problems with very large files if certain optimization options are set. You can improve build times with the following workaround:</p>
                    <p>In the Simulink Coder settings set the <span class="GUI">Compiler optimization level</span> to <span class="GUI">Optimizations off (faster builds)</span>. Depending on the MATLAB version, this setting is located on different pages of the configuration dialog; for the exact location, consult the MATLAB help. This will speed up the build process significantly. However, the generated DLL is somewhat slower at runtime. This means that this option should not be selected for performance-critical production code; it is, however, a good alternative during developing models.</p>
                </div>
                <div>
                    <h2>Exported CAPL functions are not compatible with CAPL Call Block when using vModules</h2>
                    <p>Currently there is unfortunately a limitation with the <a href="../../../CAPLFunctions/MATLAB/CAPLfunctionsMATLABOverview.htm">exported CAPL functions</a> in combination with the <span class="bold"><a href="CANoeIOLibrary/MATLABioLibCAPLcall.htm">CAPL Call functionality</a></span>, these two features cannot be used together with <span class="bold">vModules</span>.</p>
                </div>
                <div>
                    <h2 class="SectionMain">Write Window Notifications</h2>
                    <div>
                        <h3 class="GroupBox">Notification regarding Performance Problems</h3>
                        <p class="StartList">Messages regarding performance problems may occur in offline mode or in synchronous mode, e.g., <a href="../../Windows/Write/WriteWindowNotifications/01SystemMessages.htm#Code01-0046">01-0046</a>. In this case, it may be helpful to tie the MATLAB process to a specific CPU. Follow the steps below for this:</p>
                        <ul>
                            <li>start <span class="GUI">Windows Task-Manager</span></li>
                            <li>switch to <span class="GUI">Processes</span></li>
                            <li>right click the MATLAB process</li>
                            <li>in the context menu click <span class="GUI">Set Affinity</span></li>
                            <li>activate one single check box for an CPU (deactivate the others)</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="GroupBox">Notification regarding System Variables</h3>
                        <p class="Bold">&lt;xx&gt;: Creation of system variable &lt;…&gt; failed! Variable with same name already defined! Remove it and try again.</p>
                        <p>The reason for this notification is the sequence of how DLLs and features are loaded in <span class="Product">CANoe</span>. Maybe the model DLL is loaded after the I/O subsystem and some I/O ports are referenced in the Simulink model. <span class="Product">CANoe</span> tries to create these system variables however, they are already defined by the I/O feature.</p>
                        <p><span class="bold">Workaround 1</span>: In the code generation settings of your Simulink model please activate the <span class="GUI">Suppress creation of System Variables</span> option.</p>
                        <p><span class="bold">Workaround 2</span>: Use different names for system variables in your Simulink model and use the <span class="GUI"><a href="../../Ribbon/File/Options/Measurement/ApplicationChannelMapping.htm">Application Channel Mapping</a></span> dialog in <span class="Product">CANoe</span> to connect them with the system variables form your desired sub system.</p>
                    </div>
                    <div>
                        <h3 class="GroupBox">Notification regarding Incompatible Changes</h3>
                        <p class="Bold">Error in port widths or dimensions.</p>
                        <p>Due to incompatible changes to the <span class="GUI">Message Input</span> and <span class="GUI">Message Output</span> blocks, the following error notifications may occur when the simulation is started from Simulink:</p>
                        <p class="SourceCode">Error in port widths or dimensions. Output port 1 of '&lt;BlockName&gt;' is a one dimensional vector with &lt;x&gt; elements.</p>
                        <p>To update you model, execute the following command in the Simulink command window:</p>
                        <p class="SourceCode">
VUpdateLegacyBlocks('&lt;ModelName&gt;', 0);</p>
                    </div>
                </div>
                <p class="LinkList">&#160;</p>
            </div>
        </div>
        <div class="Footer">
            <div class="FooterWhite">
                <table class="FooterWhite" style="border-collapse: collapse;margin-left: auto;margin-right: auto;">
                    <col style="width: 70px;" data-mc-conditions="vConditions.HTML5Link" />
                    <col style="width: 16px;" data-mc-conditions="vConditions.HTML5Link" />
                    <col />
                    <tbody>
                        <tr>
                            <td>
                                <div class="buttons popup-container clearfix topicToolbarProxy topicToolbarProxyFooter _Skins_HTML5TopicToolbar mc-component nocontent">
                                    <div class="button-group-container-left">
                                        <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                            <div>
                                                <div role="img" class="button-icon-wrapper" aria-label="Expand all">
                                                    <div class="button-icon"> </div>
                                                </div>
                                            </div>
                                        </button>
                                        <button class="button needs-pie remove-highlight-button" title="Remove Highlights">
                                            <div>
                                                <div role="img" class="button-icon-wrapper">
                                                    <div class="button-icon"> </div>
                                                </div>
                                            </div>
                                        </button>
                                    </div>
                                </div>
                            </td>
                            <td>
                                <p class="vec_BuildInfo"><a href="../../../Shared/HowToUseOnlineHelp.htm" title="Tips for using the help" alt="Tips for using the help"><img src="../../../../Resources/vImages/vBackstage/vHelpInfo.png" /></a>
                                </p>
                            </td>
                            <td>
                                <p class="vec_BuildInfo" style="text-align: right;"><span class="mc-variable Vector.BuildTime variable">2023-09-26T19:49:32</span>
                                </p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <table style="width: 100%;border-collapse: separate;border-spacing: 3px 0px;margin-left: auto;margin-right: auto;caption-side: top;">
                <col />
                <col />
                <col />
                <col data-mc-conditions="vConditions.HTML5Link" />
                <tbody>
                    <tr>
                        <td style="background-color: #b70032;padding-left: 5pt;padding-right: 5pt;padding-top: 5pt;padding-bottom: 5pt;">
                            <p class="vec_Footer">©&#160;Vector Informatik GmbH</p>
                        </td>
                        <td style="background-color: #b70032;padding-left: 5pt;padding-right: 5pt;padding-top: 5pt;padding-bottom: 5pt;text-align: right;">
                            <p class="vec_FooterBold">
                                <MadCap:conditionalText data-mc-conditions="vConditions.vTESTstudioExcluded,vConditions.TestDataEditorExcluded">CANoe</MadCap:conditionalText> Version <MadCap:conditionalText data-mc-conditions="vConditions.vTESTstudioExcluded">17 SP3</MadCap:conditionalText></p>
                        </td>
                        <td style="background-color: #b70032;padding-left: 5pt;padding-right: 5pt;padding-top: 5pt;padding-bottom: 0pt;text-align: right;">
                            <p class="vec_Footer"><a href="../../../Shared/ContactCopyrightLicense.htm" class="vec_Footer MCXref xref xrefvec_Footer">Contact/Copyright/License</a>
                            </p>
                        </td>
                        <td style="background-color: #b70032;padding-left: 5pt;padding-right: 5pt;padding-top: 5pt;padding-bottom: 0pt;text-align: right;">
                            <p class="vec_Footer"><a href="https://www.vector.com/int/en/company/get-info/privacy-policy/" target="_blank" class="vec_Footer">Data Privacy Notice</a>
                            </p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </body>
</html>
<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="" data-mc-search-type="Stem" data-mc-help-system-file-name="CANoeCANalyzer.xml" data-mc-path-to-help-system="../../../../" data-mc-conditions="vConditions.CANoeOnly" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" /><title>GB/T 27930 Simulation (SmartCharging Sample Configuration)</title>
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Resources/Stylesheets/vTableMasterPageHeader.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link href="../../../Resources/Stylesheets/vStylesheet.css" rel="stylesheet" type="text/css" />
        <style>/*&lt;meta /&gt;*/

.button.expand-all-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.button.remove-highlight-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.button.collapse-all-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.needs-pie
{
	behavior: url('../../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../../Resources/Stylesheets/vTable.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link href="../../../Resources/Stylesheets/vTableSymbol.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapGlobal.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapDom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapUtilities.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapXhr.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapTextEffects.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapSlideshow.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapMessageBus.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapMessageBus.CrossFrame.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapDefault.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapMediaQueries.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAccessibility.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapHelpSystem.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAliasFile.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapTopicFeedback.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapFeedbackHelper.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapSkinHelper.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapToc.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapToc.Breadcrumbs.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapToc.MiniToc.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapToc.SideMenu.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapIndex.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapGlossary.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapParser.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapSearch.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapNavigateTopics.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapLms.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapELearning.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapTopic.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapFeedback.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapMicroContentComponent.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapSearchHelper.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapTopicElements.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapTriPane.js" type="text/javascript" defer="defer">
        </script>
        <script type="text/jscript" src="../../../Resources/vScripts/SyntaxHighlighting.js">
        </script>
        <script type="text/jscript" src="../../../Resources/vScripts/TabSwitch.js">
        </script>
        <script type="text/javascript" src="../../../Resources/vScripts/Vector.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../../CANoeCANalyzer.htm#Topics/SampConf/SmartCharging/SCGBT27930Simulation.htm">Open topic with navigation</a>
        </p>
        <div class="Body">
            <div role="main" id="mc-main-content">
                <div>
                    <p class="StructurePath"><a href="../CANoeCANalyzerSampleConfigurations.htm" class="StructurePath">Sample Configurations</a> » <a href="SampConfSmartCharging.htm" class="StructurePath">SmartCharging</a> » GB/T 27930 Simulation</p>
                    <h1>GB/T 27930 Simulation</h1>
                    <p class="MenuPath">&#160;</p>
                    <p class="AutoSearchFilterConcepts"><a name="aanchor10719"></a>
                        <MadCap:concept term="SFSampConf" />
                    </p>
                    <p class="IndexConcept"><a name="kanchor8636"></a><a name="kanchor8637"></a><a name="kanchor8638"></a>
                        <br />
                    </p>
                </div>
                <div>
                    <table style="width: 100%;margin-left: 0;margin-right: auto;mc-table-style: url('../../../Resources/Stylesheets/vTableSymbol.css');" class="TableStyle-vTableSymbol" cellspacing="0">
                        <col class="TableStyle-vTableSymbol-Column-Column1" />
                        <col class="TableStyle-vTableSymbol-Column-Column2" />
                        <tbody>
                            <tr>
                                <td class="TableStyle-vTableSymbol-BodyB-Column1-">
                                    <p class="TableHead">
                                        <img src="../../../Resources/vImages/vExample.png" style="width: 48px;height: 45px;" title="Example" alt="Example" />
                                    </p>
                                </td>
                                <td class="TableStyle-vTableSymbol-BodyA-Column2-">
                                    <p class="Table">Click on the blue link to load the sample configuration in <span class="Product">CANoe</span>.</p>
                                    <ul>
                                        <li>
                                            <p><span class="bold">GB/T 27930 (2015) Simulation</span> - <span class="bold"><a href="javascript:startCANoeLauncher('&quot;SAMPLES:\\SmartCharging\\GBT27930\\Simulation2015\\GBT_27930_2015_Simulation.cfg&quot;')" class="ExecuteLink">GBT_27930_2015_Simulation.cfg</a></span><br />Simulates a charging station and a battery management system that communicate with each other according to GB/T 27930 (2015).</p>
                                            <p><span class="bold">GB/T 27930 (2011) Simulation</span> - <span class="bold"><a href="javascript:startCANoeLauncher('&quot;SAMPLES:\\SmartCharging\\GBT27930\\Simulation2011\\GBT_27930_2011_Simulation.cfg&quot;')" class="ExecuteLink">GBT_27930_2011_Simulation.cfg</a></span><br />Simulates a charging station and a battery management system that communicate with each other according to GB/T 27930 (2011).</p>
                                        </li>
                                    </ul>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <h2>Introduction</h2>
                <p>The GB/T 27930 standard describes how a charging station (<span class="bold">Charger</span>) and a battery management system (<span class="bold">BMS</span>) communicate with each other via CAN during a charging process. To simulate and test such systems quickly and easily, the special Interaction Layer <span class="SourceCode">GBT27930_IL.dll</span> is available, which can simulate both a charging station and a battery management system. In this example the simulation of a system based on <span class="SourceCode">GBT27930_IL.dll</span> is shown.</p>
                <p>Since there are currently two edits of the GB/T 27930 standard (from 2011 and 2015), we provide a separate simulation for each edit. The description fits for both variants, because differences between both standards are manageable. The following table presents these differences clearly:</p>
                <table style="mc-table-style: url('../../../Resources/Stylesheets/vTable.css');" class="TableStyle_vTable" cellspacing="0">
                    <col />
                    <col />
                    <col />
                    <tbody>
                        <tr>
                            <th class="TableStyle_vTable_Body_0_0_RowSep_ColSep">&#160;</th>
                            <th class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="TableHead">GB/T 27930-2011</p>
                            </th>
                            <th class="TableStyle_vTable_Body_0_0_RowSep_ColEnd">
                                <p class="TableHead">GB/T 27930-2015</p>
                            </th>
                        </tr>
                        <tr>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">New message types</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">&#160;</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColEnd">
                                <p class="Table">CHM, BHM</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">J1939 priority</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">Priority 6 for BRM, BCP, BCS, BMV, BMT and BSP</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColEnd">
                                <p class="Table">Priority 7 for BRM, BCP, BCS, BMV, BMT and BSP</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">Message period</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">1 second for
BMV, BMT and BSP
</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColEnd">
                                <p class="Table">10 seconds for
BMV, BMT and BSP
</p>
                            </td>
                        </tr>
                        <tr>
                            <th colspan="3" class="TableStyle_vTable_Body_0_0_RowSep_ColEnd">
                                <p colspan="3" class="TableHead">Message Layout</p>
                            </th>
                        </tr>
                        <tr>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">BRM length</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">41 bytes</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColEnd">
                                <p class="Table">49 bytes</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">BCP: SPN2822</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">Total voltage</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColEnd">
                                <p class="Table">Current voltage</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">BST: SPN3511</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">&#160;</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColEnd">
                                <p class="Table">Additional suspending reason:
“charger actively suspends”
</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">BST: SPN3512</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">&#160;</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColEnd">
                                <p class="Table">Additional suspending reasons:</p>
                                <p class="Table">“high voltage relay fault”</p>
                                <p class="Table">“voltage detection fault”</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">CRM: SPN2561</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">Length: 1 byte</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColEnd">
                                <p class="Table">Length: 4 bytes</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">CRM: SPN2562</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">Length: 6 bytes; optional</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColEnd">
                                <p class="Table">Length: 3 bytes; mandatory</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">CCS length</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">6 bytes</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColEnd">
                                <p class="Table">8 bytes</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">CCS: SPN3929</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">Not defined</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColEnd">
                                <p class="Table">Mandatory</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">CSD length</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">5 bytes</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColEnd">
                                <p class="Table">8 bytes</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">CSD: SPN3613</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">1 byte</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColEnd">
                                <p class="Table">4 bytes</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">CML length</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColSep">
                                <p class="Table">6 bytes</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowSep_ColEnd">
                                <p class="Table">8 bytes</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="TableStyle_vTable_Body_0_0_RowEnd_ColSep">
                                <p class="Table">CML: SPN2827</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowEnd_ColSep">
                                <p class="Table">Not defined</p>
                            </td>
                            <td class="TableStyle_vTable_Body_0_0_RowEnd_ColEnd">
                                <p class="Table">Mandatory</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p>Both participants (<span class="bold">Charger </span>and <span class="bold">BMS</span>) are represented by their own simulation nodes. All data relevant for the simulation of the respective node are displayed in the corresponding panel and can be adapted there. After starting the measurement, both nodes must be started via the button <span class="GUI">(Re)Start charging (close K3 and K4)</span>. Then the simulated <span class="bold">Chargers</span> and <span class="bold">BMS</span> go through the first phases of communication (<span class="bold">Handshake initiation</span>, <span class="bold">Handshake recognition</span> and <span class="bold">Parameter configuration</span>) and move on to the <span class="GUI">Charging</span> phase. This phase can last as long as you want - until you end it manually.</p>
                <p>The bus communication is displayed in two Trace Windows:</p>
                <ul>
                    <li><span class="GUI">Trace filtered</span>: The bus communication is reduced to the essentials.</li>
                    <li><span class="GUI">Trace all</span>: The bus communication is displayed completely.</li>
                </ul>
                <div>
                    <h3>Manipulating Individual Signals</h3>
                    <ol>
                        <li value="1">
                            <p class="ListItem">Signals that are displayed in black in the panel can be changed directly. The easiest way is to set new values directly in the panel. Alternatively you can set signals in CAPL. Here is an example of how to set <span class="SourceCode">CML::MaxOutputVoltage</span> to 333 V using the <span class="bold">Y</span> key:</p>
                            <p class="SourceCode">on key 'y'<br />{<br />&#160;&#160;$CML::MaxOutputVoltage = 333;<br />}</p>
                            <p>However, two points must be taken into account here:</p>
                            <ul>
                                <li>The <span class="bold">Y</span> key must be pressed before the CML message is sent.</li>
                                <li>The new value of the newly set signal is changed in the Panel only after the corresponding message has appeared on the bus.</li>
                            </ul>
                        </li>
                        <li value="2">
                            <p class="ListItem">Signals that are displayed in blue in the panel are mostly already set in CAPL (either in Charger.can or in BMS.can). If you want to set these signals to another value, you have to change corresponding places in CAPL files.</p>
                        </li>
                        <li value="3">
                            <p class="ListItem">Content of the CTS message (current date/time) is completely set in the modeling library GBT27930_IL. To manipulate individual or all signals, you must implement the callback function <a href="../../CAPLFunctions/J1939/GBT27930InteractionLayer/Functions/CAPLfunctionGBT27930ILOnTxPrepare.htm" class="SourceCode">GBT27930IL_OnTxPrepare</a> and modify the message content there in the desired way. In the following example signals <span class="SourceCode">CTS::Centuries</span>, <span class="SourceCode">CTS::Years</span> and <span class="SourceCode">CTS::Hours</span> are modified:</p>
                            <p class="SourceCode">long GBT27930IL_OnTxPrepare(pg * txPG)<br />{<br />&#160;&#160;if(txPG.pgn == CTS.PGN)<br />&#160;&#160;{<br />&#160;&#160;&#160;&#160;pg CTS myCTS;<br /><br />&#160;&#160;&#160;&#160;myCTS = txPG;<br />&#160;&#160;&#160;&#160;myCTS.Centuries = 0x20;<br />&#160;&#160;&#160;&#160;myCTS.Years = 0x24;<br />&#160;&#160;&#160;&#160;myCTS.Hours = 0x12;<br />&#160;&#160;&#160;&#160;txPG = myCTS;<br />&#160;&#160;}<br />&#160;&#160;return 1;<br />}</p>
                        </li>
                    </ol>
                </div>
                <h2><a name="Shortcuts" id="Shortcuts"></a>Desktops</h2>
                <p>This configuration contains the following desktops:</p>
                <h2 class="NavigationS">Setup</h2>
                <p>Two nodes are configured in the Simulation Setup: <span class="GUI">Charger </span>and <span class="GUI">BMS</span>. Each node is simulated by <span class="SourceCode">GBT27930_IL.dll</span>. Special adjustments are made in the respective CAPL file that is assigned to each simulation node.</p>
                <p>In the case of a remaining bus simulation, both nodes can be deactivated and replaced by the real device. The simulation should then be switched from <span class="GUI">Simulated Bus </span>mode to <span class="GUI">Real Bus</span> mode.</p>
                <p>Two Trace Windows are configured in the Measurement Setup: <span class="GUI">Trace all </span>and <span class="GUI">Trace filtered</span>.</p>
                <p>While <span class="GUI">Trace all</span> displays everything, only messages that transfer new information are displayed in <span class="GUI">Trace filtered</span>. This prevents many cyclic messages that are sent several times per second with the same contents from filling the Trace Window with redundant information. This intelligent filtering is performed by the CAPL node <span class="GUI">SmartFilter</span>, which is installed before the <span class="GUI">Trace filtered</span> window.</p>
                <p>The Measurement Setup also contains the additional CAPL node <span class="GUI">SetColor</span>. This node colors messages according to the communication phase. Thus, all messages from the same communication phase have the same color.</p>
                <h2 class="NavigationS">Charger and BMS</h2>
                <p>In the <span class="GUI">Charger</span> and <span class="GUI">BMS</span> panel, you can configure all parameters that are relevant for the charging simulation of the respective participant. This information is grouped according to the messages. For some messages, you cannot determine the content yourself, but instead the content is defined either by the <span class="SourceCode">GBT27930_IL.dll</span> or the CAPL file. Such data fields are colored blue.</p>
                <p>First you should start the measurement in <span class="Product">CANoe</span>.</p>
                <p>You can define the delay with which each simulated node changes from one state to the next. For this you have the data group <span class="GUI">Delay change (ms)</span>, which is located in the lower half on the <span class="GUI">Control</span> page of the respective panel. You can also define the maximum time allowed for the other participant to start sending a specific message. For this you have the data group <span class="GUI">Max. allowed missing time (ms)</span>, which is located at the bottom on the <span class="GUI">Control</span> page of the respective panel. The entered data can be saved with Store Settings.</p>
                <p>To start the charging simulation you have to click the button <span class="GUI">(Re)Start charging (close K3 and K4)</span>. The simulated Chargers and BMS go through the first phases of communication (Handshake initiation, Handshake recognition and Parameter configuration) and move on to the Charging phase.</p>
                <p>The state transitions of the Charger and BMS are shown in the <span class="GUI">StateDiagram</span> panel. After initialization all state fields are gray, the achieved state is colored green. If a state was not reached or reached too late, it is colored red and the transition is marked. Depending on which node finishes the loading process, the diagram is extended by the BST/CST and BSD/CSD messages. The states are reset with each new loading process and measurement start. During the measurement the diagram can also be reset using the <span class="GUI">Reset </span>button.</p>
                <p>You must end the <span class="GUI">Charging</span> phase manually. Three options are available for this:</p>
                <ol>
                    <li value="1">The simulated node runs through the <span class="GUI">Suspension of charging</span> and <span class="GUI">End of charging</span> phases. To do this, use the <span class="GUI">Suspend charging. Cause:</span> button in the upper part of the panel of the node that will initiate the suspension. In the list directly below, you can select the cause of the suspension to be communicated with the message <span class="GUI">Suspend Charging</span>. Alternatively you can also use the <span class="GUI">Suspend charging</span> button on the <span class="GUI">CST/CEM</span> resp. <span class="GUI">BST / BEM</span> page: in this case you can define one or more causes for the suspension.</li>
                    <li value="2">You can end the charging process with an error: the simulated node stops its regular communication and instead begins to send the error message (<span class="bold">CEM </span>or <span class="bold">BEM</span>). To do this, use the <span class="GUI">Send CEM with timeout of:</span> resp. <span class="GUI">Send BEM with timeout of:</span> button in the upper part of the panel of the node that will signal the error. In the list directly below, you can select the missing message to be communicated with the error notification. Alternatively you can also use the <span class="GUI">Stop charging with error</span> button on the <span class="GUI">CST/CEM</span> resp. <span class="GUI">BST / BEM</span> page: in this case you can define one or more messages with the timeout.</li>
                    <li value="3">You can terminate all communication of the simulation node immediately. Clicking the <span class="GUI">(Re)Start charging (close K3 and K4)</span> button will immediately stop the communication, and releasing it will restart the communication.</li>
                </ol>
                <h2 class="NavigationS">Measurement</h2>
                <p>On this desktop you have the following Trace Windows:</p>
                <ul>
                    <li><span class="bold">Trace filtered</span> can be used to get a quick overview of the entire charging process.</li>
                    <li><span class="bold">Trace all</span> can be used to analyze the entire bus traffic.</li>
                </ul>
                <p class="LinkList"><a href="../../CANoeCANalyzer/SmartCharging/SmartCharging.htm" class="LinkList">Option&#160;SmartCharging</a>
                </p>
            </div>
        </div>
        <div class="Footer">
            <div class="FooterWhite">
                <table class="FooterWhite" style="border-collapse: collapse;margin-left: auto;margin-right: auto;">
                    <col style="width: 70px;" data-mc-conditions="vConditions.HTML5Link" />
                    <col style="width: 16px;" data-mc-conditions="vConditions.HTML5Link" />
                    <col />
                    <tbody>
                        <tr>
                            <td>
                                <div class="buttons popup-container clearfix topicToolbarProxy topicToolbarProxyFooter _Skins_HTML5TopicToolbar mc-component nocontent">
                                    <div class="button-group-container-left">
                                        <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                            <div>
                                                <div role="img" class="button-icon-wrapper" aria-label="Expand all">
                                                    <div class="button-icon"> </div>
                                                </div>
                                            </div>
                                        </button>
                                        <button class="button needs-pie remove-highlight-button" title="Remove Highlights">
                                            <div>
                                                <div role="img" class="button-icon-wrapper">
                                                    <div class="button-icon"> </div>
                                                </div>
                                            </div>
                                        </button>
                                    </div>
                                </div>
                            </td>
                            <td>
                                <p class="vec_BuildInfo"><a href="../../Shared/HowToUseOnlineHelp.htm" title="Tips for using the help" alt="Tips for using the help"><img src="../../../Resources/vImages/vBackstage/vHelpInfo.png" /></a>
                                </p>
                            </td>
                            <td>
                                <p class="vec_BuildInfo" style="text-align: right;"><span class="mc-variable Vector.BuildTime variable">2023-09-26T19:49:32</span>
                                </p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <table style="width: 100%;border-collapse: separate;border-spacing: 3px 0px;margin-left: auto;margin-right: auto;caption-side: top;">
                <col />
                <col />
                <col />
                <col data-mc-conditions="vConditions.HTML5Link" />
                <tbody>
                    <tr>
                        <td style="background-color: #b70032;padding-left: 5pt;padding-right: 5pt;padding-top: 5pt;padding-bottom: 5pt;">
                            <p class="vec_Footer">©&#160;Vector Informatik GmbH</p>
                        </td>
                        <td style="background-color: #b70032;padding-left: 5pt;padding-right: 5pt;padding-top: 5pt;padding-bottom: 5pt;text-align: right;">
                            <p class="vec_FooterBold">
                                <MadCap:conditionalText data-mc-conditions="vConditions.vTESTstudioExcluded,vConditions.TestDataEditorExcluded">CANoe</MadCap:conditionalText> Version <MadCap:conditionalText data-mc-conditions="vConditions.vTESTstudioExcluded">17 SP3</MadCap:conditionalText></p>
                        </td>
                        <td style="background-color: #b70032;padding-left: 5pt;padding-right: 5pt;padding-top: 5pt;padding-bottom: 0pt;text-align: right;">
                            <p class="vec_Footer"><a href="../../Shared/ContactCopyrightLicense.htm" class="vec_Footer MCXref xref xrefvec_Footer">Contact/Copyright/License</a>
                            </p>
                        </td>
                        <td style="background-color: #b70032;padding-left: 5pt;padding-right: 5pt;padding-top: 5pt;padding-bottom: 0pt;text-align: right;">
                            <p class="vec_Footer"><a href="https://www.vector.com/int/en/company/get-info/privacy-policy/" target="_blank" class="vec_Footer">Data Privacy Notice</a>
                            </p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </body>
</html>